/* ---------- THEME ---------- */
:root{
  --bg: #0b0e14;
  --panel: #111522;
  --panel-2:#161b2c;
  --text: #e8ecf1;
  --muted:#9aa4b2;
  --accent:#6c63ff;
  --accent-2:#4caf50;
  --danger:#ff5d5d;
  --bubble-user:#1d263d;
  --bubble-bot:#171c2e;
  --border: #22283c;
  --shadow: 0 10px 30px rgba(0,0,0,.35);
  --sidebar-w: 280px;
}
body[data-theme="light"]{
  --bg:#f4f7fc; --panel:#ffffff; --panel-2:#ffffff; --text:#0b1220; --muted:#5a667a;
  --accent:#5b55ff; --accent-2:#2faa58; --bubble-user:#e7f1ff; --bubble-bot:#f2f4f7;
  --border:#e6e9f2; --shadow: 0 8px 24px rgba(9,30,66,.12);
}

/* ---------- BASE ---------- */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; background: var(--bg); color: var(--text);
  font: 15px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  transition: background .3s ease, color .3s ease;
}
.btn{
  background: var(--panel-2); border:1px solid var(--border); color:var(--text);
  padding:8px 10px; border-radius:10px; cursor:pointer; transition:.15s;
}
.btn:hover{ transform: translateY(-1px) }
.btn.icon{ padding:8px 10px; }
.only-mobile{ display:none }

/* ---------- LAYOUT WITH SIDEBAR ---------- */
.app-with-sidebar{
  height: 100vh;
  display:grid;
  grid-template-columns: var(--sidebar-w) 1fr;
}
.sidebar{
  background: var(--panel); border-right:1px solid var(--border);
  display:flex; flex-direction:column; height:100vh; position:sticky; left:0; top:0;
}
.sidebar-header{
  display:flex; gap:10px; align-items:center; padding:14px 14px 10px;
  border-bottom:1px solid var(--border);
}
.sidebar .logo{ font-size:22px }
.brand-title{ font-weight:700 }
.sidebar-actions{ padding:10px 12px }
.new-chat{ width:100%; background: var(--accent); color:#fff; border-color:transparent }
.chat-list{ padding:6px 8px; overflow:auto; flex:1 }
.chat-item{
  display:flex; align-items:center; gap:10px; padding:10px 12px; border-radius:10px; cursor:pointer;
}
.chat-item:hover{ background: var(--panel-2) }
.chat-item.active{ outline:2px solid var(--accent); background: var(--panel-2) }
.chat-item .title{ flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis }
.chat-item .time{ font-size:11px; color:var(--muted) }
.chat-item .trash{ opacity:.7; cursor:pointer }
.chat-item .trash:hover{ opacity:1 }
.sidebar-footer{ padding:10px 12px; border-top:1px solid var(--border); color:var(--muted) }

.main{ display:grid; grid-template-rows:auto 1fr auto auto; height:100vh; }

/* ---------- HEADER / STATUS ---------- */
.app-header{
  display:flex; align-items:center; justify-content:space-between;
  padding: 12px 14px; background: var(--panel); border-bottom:1px solid var(--border);
  box-shadow: var(--shadow); position: sticky; top:0; z-index:2;
}
.brand{ display:flex; gap:10px; align-items:center }
.brand .logo{ font-size:24px }
.title{ font-weight:700 }
.subtitle{ font-size:12px; color:var(--muted) }
.status-dot{ width:8px; height:8px; border-radius:999px; display:inline-block; margin-right:6px; vertical-align:middle }
.status-dot.online{ background: var(--accent-2) }
.status-dot.offline{ background: var(--danger) }
.status-dot.idle{ background: var(--accent) }

/* ---------- CHAT ---------- */
.chat{ padding:16px; overflow-y:auto; display:flex; flex-direction:column; gap:10px }
.msg{ display:flex; gap:10px; max-width:80%; animation: pop .08s ease }
.msg.right{ align-self:flex-end; flex-direction: row-reverse }
.avatar{ width:32px; height:32px; border-radius:12px; background: var(--panel-2);
  display:flex; align-items:center; justify-content:center; border:1px solid var(--border) }
.bubble{ padding:10px 12px; border-radius:14px; background: var(--bubble-bot);
  border:1px solid var(--border); box-shadow: var(--shadow) }
.msg.right .bubble{ background: var(--bubble-user) }
.meta{ margin-top:6px; font-size:11px; color:var(--muted); display:flex; gap:8px; align-items:center }
.copy{ cursor:pointer; opacity:.7 }
.copy:hover{ opacity:1 }

.typing{ display:inline-flex; gap:5px; align-items:center }
.dot{ width:6px; height:6px; border-radius:50%; background: var(--muted); opacity:.5; animation: blink 1s infinite }
.dot:nth-child(2){ animation-delay:.2s } .dot:nth-child(3){ animation-delay:.4s }

/* ---------- COMPOSER ---------- */
.composer{
  display:flex; gap:8px; padding: 12px; background: var(--panel);
  border-top: 1px solid var(--border); position: sticky; bottom:0; z-index:2;
}
#input{
  flex:1; resize:none; min-height:42px; max-height:160px;
  border-radius: 12px; border:1px solid var(--border); padding: 10px 12px;
  background: var(--panel-2); color: var(--text); outline:none;
}
.btn-send{
  width: 46px; border-radius: 12px; border:1px solid var(--border);
  background: var(--accent); color: #fff; cursor:pointer; font-size:18px;
  display:flex; align-items:center; justify-content:center; transition:.15s;
}
.btn-send:hover{ filter: brightness(1.05) } .btn-send:active{ transform: translateY(1px) }

.disclaimer{ text-align:center; color: var(--muted); font-size:12px; padding:8px }

/* ---------- CODE ---------- */
pre, code{ white-space: pre-wrap; word-wrap: break-word }
pre code{ display:block; padding:10px; border-radius:10px; border:1px solid var(--border); background: var(--panel-2) }

/* ---------- SCROLL ---------- */
.chat::-webkit-scrollbar{ width:10px } .chat::-webkit-scrollbar-thumb{ background:#00000033; border-radius:99px }

/* ---------- ANIM ---------- */
@keyframes pop{ from{ transform: translateY(4px); opacity:0 } to{ transform: translateY(0); opacity:1 } }
@keyframes blink{ 0%{opacity:.3} 50%{opacity:1} 100%{opacity:.3} }

/* ---------- RESPONSIVE ---------- */
@media (max-width: 820px){
  .app-with-sidebar{ grid-template-columns: 0 1fr }
  .sidebar{ position: fixed; left:0; top:0; bottom:0; width: var(--sidebar-w);
    transform: translateX(-100%); transition: transform .2s ease; z-index: 5 }
  .sidebar.open{ transform: translateX(0) }
  .only-mobile{ display:inline-block }
  .msg{ max-width: 95% }
}
